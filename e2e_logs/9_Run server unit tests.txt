2025-09-19T12:22:28.1742404Z ##[group]Run # Run server unit tests with Node experimental VM modules enabled so Mocha
2025-09-19T12:22:28.1743233Z [36;1m# Run server unit tests with Node experimental VM modules enabled so Mocha[0m
2025-09-19T12:22:28.1743719Z [36;1m# can load ESM-only dependencies without ERR_REQUIRE_ESM on the runner.[0m
2025-09-19T12:22:28.1744323Z [36;1m# This is a minimal, low-risk change to the CI environment.[0m
2025-09-19T12:22:28.1744640Z [36;1mset -euo pipefail[0m
2025-09-19T12:22:28.1744887Z [36;1mecho "Running server unit tests (mocha)"[0m
2025-09-19T12:22:28.1745353Z [36;1mNODE_OPTIONS="--experimental-vm-modules" \[0m
2025-09-19T12:22:28.1745832Z [36;1m  node ./node_modules/.bin/mocha --recursive --reporter spec[0m
2025-09-19T12:22:28.1776812Z shell: /usr/bin/bash -e {0}
2025-09-19T12:22:28.1777033Z env:
2025-09-19T12:22:28.1777229Z   NODE_OPTIONS: --experimental-vm-modules
2025-09-19T12:22:28.1777478Z ##[endgroup]
2025-09-19T12:22:28.1828502Z Running server unit tests (mocha)
2025-09-19T12:22:28.5513281Z 
2025-09-19T12:22:28.5515457Z  Exception during run: Error [ERR_REQUIRE_ESM]: require() of ES Module /home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/node_modules/nanoid/index.js from /home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/index.js not supported.
2025-09-19T12:22:28.5519145Z Instead change the require of /home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/node_modules/nanoid/index.js in /home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/index.js to a dynamic import() which is available in all CommonJS modules.
2025-09-19T12:22:28.5521516Z     at Object.<anonymous> (/home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/index.js:8:20)
2025-09-19T12:22:28.5522810Z     at Object.<anonymous> (/home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/test/endpoints.spec.js:6:13)
2025-09-19T12:22:28.5524285Z     at async formattedImport (/home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/node_modules/mocha/lib/nodejs/esm-utils.js:9:14)
2025-09-19T12:22:28.5525941Z     at async exports.requireOrImport (/home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/node_modules/mocha/lib/nodejs/esm-utils.js:42:28)
2025-09-19T12:22:28.5527256Z     at async exports.loadFilesAsync (/home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/node_modules/mocha/lib/nodejs/esm-utils.js:100:20)
2025-09-19T12:22:28.5528240Z     at async singleRun (/home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/node_modules/mocha/lib/cli/run-helpers.js:162:3)
2025-09-19T12:22:28.5529155Z     at async exports.handler (/home/runner/work/Picsbyeli.github.io/Picsbyeli.github.io/server/node_modules/mocha/lib/cli/run.js:375:5) {
2025-09-19T12:22:28.5529707Z   code: 'ERR_REQUIRE_ESM'
2025-09-19T12:22:28.5529928Z }
2025-09-19T12:22:28.5588799Z ##[error]Process completed with exit code 1.

<!DOCTYPE html>
<html>
<head>
  <title>20 Questions - E.Vol Games</title>
  <script src="../js/music-persistence.js"></script>
  <style>
    body {
      background: linear-gradient(to bottom right, #9333ea, #3b82f6);
      font-family: 'Inter', sans-serif;
      color: white;
      text-align: center;
      padding: 20px;
      min-height: 100vh;
      margin: 0;
    }
    .game-container {
      max-width: 800px;
      margin: 0 auto;
      background: rgba(255,255,255,0.1);
      padding: 30px;
      border-radius: 16px;
      backdrop-filter: blur(15px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    .back-btn {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      padding: 12px 18px;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s ease;
    }
    .back-btn:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
    }
    .category-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }
    .category-card {
      background: rgba(255,255,255,0.15);
      border: 2px solid rgba(255,255,255,0.2);
      padding: 25px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .category-card:hover {
      background: rgba(255,255,255,0.25);
      transform: translateY(-5px) scale(1.02);
      box-shadow: 0 15px 35px rgba(0,0,0,0.3);
    }
    .category-card h3 {
      margin: 0 0 10px 0;
      font-size: 24px;
      text-transform: capitalize;
    }
    .category-card p {
      margin: 0;
      opacity: 0.8;
      font-size: 14px;
    }
    .question-section {
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.2);
      border-radius: 12px;
      padding: 25px;
      margin: 20px 0;
    }
    .questions-counter {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 20px;
      color: #ffd700;
    }
    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(255,255,255,0.2);
      border-radius: 4px;
      margin: 10px 0;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #4ade80, #ffd700, #f87171);
      border-radius: 4px;
      transition: width 0.3s ease;
    }
    .questions-list {
      max-height: 300px;
      overflow-y: auto;
      margin: 20px 0;
      text-align: left;
    }
    .question-item {
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      padding: 15px;
      margin: 10px 0;
    }
    .question-text {
      font-weight: bold;
      margin-bottom: 5px;
    }
    .answer-text {
      font-size: 16px;
      font-weight: bold;
      margin-top: 8px;
    }
    .answer-yes { color: #4ade80; }
    .answer-no { color: #f87171; }
    .input-section {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
      justify-content: center;
    }
    .input-field {
      flex: 1;
      min-width: 250px;
      padding: 12px 16px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 8px;
      background: rgba(255,255,255,0.1);
      color: white;
      font-size: 16px;
    }
    .input-field::placeholder {
      color: rgba(255,255,255,0.7);
    }
    .input-field:focus {
      outline: none;
      border-color: rgba(255,255,255,0.6);
      background: rgba(255,255,255,0.15);
    }
    .btn {
      background: rgba(255,255,255,0.2);
      border: 2px solid rgba(255,255,255,0.3);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 16px;
      font-weight: 500;
    }
    .btn:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
    }
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    .btn-primary {
      background: linear-gradient(45deg, #667eea, #764ba2);
      border: none;
    }
    .btn-success {
      background: linear-gradient(45deg, #4ade80, #22c55e);
      border: none;
    }
    .btn-danger {
      background: linear-gradient(45deg, #f87171, #ef4444);
      border: none;
    }
    .game-result {
      background: rgba(255,255,255,0.15);
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 12px;
      padding: 25px;
      margin: 20px 0;
    }
    .result-won {
      border-color: #4ade80;
      background: rgba(74, 222, 128, 0.2);
    }
    .result-lost {
      border-color: #f87171;
      background: rgba(248, 113, 113, 0.2);
    }
    .result-icon {
      font-size: 48px;
      margin-bottom: 15px;
    }
    .game-info {
      background: rgba(139, 69, 19, 0.3);
      border: 2px solid rgba(255,255,255,0.2);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      text-align: left;
      border-left: 4px solid #ffd700;
    }
    .category-info {
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 10px 15px;
      margin: 10px 0;
      display: inline-block;
    }
    @media (max-width: 600px) {
      .input-section {
        flex-direction: column;
      }
      .input-field {
        min-width: auto;
      }
      .category-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <a href="../index.html" class="back-btn">‚Üê Back to Home</a>
  
  <div class="game-container">
    <h1>
      <span style="font-size: 1.2em;">ü§î</span> 
      20 Questions Game
      <span style="font-size: 1.2em;">‚ùì</span>
    </h1>
    
    <!-- Category Selection Screen -->
    <div id="category-screen">
      <p>Choose a category to begin! I'll think of something from that category, and you have 20 yes/no questions to guess what it is.</p>
      
      <div class="category-grid">
        <div class="category-card" onclick="startNewGame('animals')">
          <h3>üêò Animals</h3>
          <p>14 different animals from pets to wild creatures</p>
        </div>
        <div class="category-card" onclick="startNewGame('objects')">
          <h3>üéπ Objects</h3>
          <p>14 everyday items and tools you might find around</p>
        </div>
        <div class="category-card" onclick="startNewGame('food')">
          <h3>üçå Food</h3>
          <p>4 different foods from fruits to treats</p>
        </div>
        <div class="category-card" onclick="startNewGame('nature')">
          <h3>üåπ Nature</h3>
          <p>4 natural elements from plants to celestial bodies</p>
        </div>
        <div class="category-card" onclick="startNewGame('vehicles')">
          <h3>‚úàÔ∏è Vehicles</h3>
          <p>3 different modes of transportation</p>
        </div>
      </div>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" style="display: none;">
      <div class="category-info">
        Category: <span id="current-category" style="font-weight: bold; text-transform: capitalize;"></span>
      </div>
      
      <div class="game-info">
        <h3>üéØ How to Play:</h3>
        <p>I'm thinking of something from your chosen category! Ask yes/no questions to figure out what it is. You have <strong><span id="questions-remaining">20</span> questions remaining</strong>.</p>
      </div>

      <div class="questions-counter">
        Questions Asked: <span id="questions-count">0</span>/20
        <div class="progress-bar">
          <div id="progress-fill" class="progress-fill"></div>
        </div>
      </div>

      <div class="question-section">
        <h3>üìù Your Questions:</h3>
        <div id="questions-list" class="questions-list">
          <p style="color: rgba(255,255,255,0.6); font-style: italic;">No questions asked yet...</p>
        </div>
      </div>

      <!-- Question Input -->
      <div id="question-input-section">
        <h3>Ask a Yes/No Question:</h3>
        <div class="input-section">
          <input type="text" id="question-input" class="input-field" 
                 placeholder="e.g., Is it alive? Does it have legs? Can it fly?" 
                 onkeypress="handleQuestionKeyPress(event)">
          <button class="btn btn-primary" onclick="askQuestion()">Ask Question</button>
        </div>
        <button class="btn btn-success" onclick="showGuessInput()" style="margin-top: 15px;">
          üéØ I'm ready to guess!
        </button>
      </div>

      <!-- Guess Input -->
      <div id="guess-input-section" style="display: none;">
        <h3>What is your guess?</h3>
        <div class="input-section">
          <input type="text" id="guess-input" class="input-field" 
                 placeholder="Enter your guess..." 
                 onkeypress="handleGuessKeyPress(event)">
          <button class="btn btn-success" onclick="submitGuess()">Submit Guess</button>
          <button class="btn" onclick="showQuestionInput()">‚Üê Back to Questions</button>
        </div>
      </div>

      <div style="margin-top: 20px;">
        <button class="btn" onclick="returnToCategories()">üîÑ New Game</button>
      </div>
    </div>

    <!-- Result Screen -->
    <div id="result-screen" style="display: none;">
      <div id="result-content" class="game-result">
        <!-- Result content will be inserted here -->
      </div>
      
      <div>
        <button class="btn btn-primary" onclick="startNewGame(selectedCategory)">üîÑ Play Again (Same Category)</button>
        <button class="btn" onclick="returnToCategories()">üìÇ Choose New Category</button>
      </div>
    </div>
  </div>

  <script>
    const CATEGORIES = {
      animals: [
        { 
          name: 'Elephant', 
          props: { 
            isAnimal: true, isLiving: true, isBig: true, hasLegs: true, canFly: false, 
            livesInWater: false, hasTrunk: true, isMammal: true, hasFur: false, hasWings: false,
            isPet: false, isDangerous: true, canSwim: true, eatsMeat: false, laysEggs: false,
            hasShell: false, hasTail: true, makesSounds: true, isWild: true, liveOnLand: true
          } 
        },
        { 
          name: 'Dolphin', 
          props: { 
            isAnimal: true, isLiving: true, livesInWater: true, isSmart: true, canSwim: true, 
            isMammal: true, canFly: false, hasLegs: false, isBig: true, hasFur: false,
            hasWings: false, isPet: false, isDangerous: false, eatsMeat: true, laysEggs: false,
            hasShell: false, hasTail: true, makesSounds: true, isWild: true, liveOnLand: false
          } 
        },
        { 
          name: 'Penguin', 
          props: { 
            isAnimal: true, isLiving: true, isBird: true, canSwim: true, canFly: false, 
            livesCold: true, hasLegs: true, isBig: false, hasFur: false, hasWings: true,
            isPet: false, isDangerous: false, eatsMeat: true, laysEggs: true, isMammal: false,
            hasShell: false, hasTail: true, makesSounds: true, isWild: true, livesInWater: true, liveOnLand: false
          } 
        },
        { 
          name: 'Cat', 
          props: { 
            isAnimal: true, isLiving: true, isMammal: true, hasLegs: true, hasFur: true,
            canFly: false, isPet: true, isBig: false, isDangerous: false, eatsMeat: true,
            laysEggs: false, hasShell: false, hasTail: true, makesSounds: true, isWild: false,
            liveOnLand: true, livesInWater: false, canSwim: false, hasWings: false
          } 
        },
        { 
          name: 'Eagle', 
          props: { 
            isAnimal: true, isLiving: true, isBird: true, canFly: true, hasWings: true,
            hasLegs: true, isBig: false, hasFur: false, isPet: false, isDangerous: true,
            eatsMeat: true, laysEggs: true, isMammal: false, hasShell: false, hasTail: true,
            makesSounds: true, isWild: true, liveOnLand: false, livesInWater: false
          } 
        },
        { 
          name: 'Snake', 
          props: { 
            isAnimal: true, isLiving: true, hasLegs: false, canFly: false, isBig: false,
            hasFur: false, hasWings: false, isPet: false, isDangerous: true, eatsMeat: true,
            laysEggs: true, isMammal: false, isBird: false, hasShell: false, hasTail: true,
            makesSounds: true, isWild: true, liveOnLand: true, livesInWater: false, canSwim: false
          } 
        },
        { 
          name: 'Dog', 
          props: { 
            isAnimal: true, isLiving: true, isMammal: true, hasLegs: true, hasFur: true,
            canFly: false, isPet: true, isBig: false, isDangerous: false, eatsMeat: true,
            laysEggs: false, hasShell: false, hasTail: true, makesSounds: true, isWild: false,
            liveOnLand: true, livesInWater: false, canSwim: true, hasWings: false
          } 
        },
        { 
          name: 'Lion', 
          props: { 
            isAnimal: true, isLiving: true, isMammal: true, hasLegs: true, hasFur: true,
            canFly: false, isPet: false, isBig: true, isDangerous: true, eatsMeat: true,
            laysEggs: false, hasShell: false, hasTail: true, makesSounds: true, isWild: true,
            liveOnLand: true, livesInWater: false, canSwim: false, hasWings: false
          } 
        },
        { 
          name: 'Butterfly', 
          props: { 
            isAnimal: true, isLiving: true, isBird: false, canFly: true, hasWings: true,
            hasLegs: true, isBig: false, hasFur: false, isPet: false, isDangerous: false,
            eatsMeat: false, laysEggs: true, isMammal: false, hasShell: false, hasTail: false,
            makesSounds: false, isWild: true, liveOnLand: false, livesInWater: false
          } 
        },
        { 
          name: 'Shark', 
          props: { 
            isAnimal: true, isLiving: true, livesInWater: true, isSmart: false, canSwim: true,
            isMammal: false, canFly: false, hasLegs: false, isBig: true, hasFur: false,
            hasWings: false, isPet: false, isDangerous: true, eatsMeat: true, laysEggs: true,
            hasShell: false, hasTail: true, makesSounds: false, isWild: true, liveOnLand: false
          } 
        },
        { 
          name: 'Rabbit', 
          props: { 
            isAnimal: true, isLiving: true, isMammal: true, hasLegs: true, hasFur: true,
            canFly: false, isPet: true, isBig: false, isDangerous: false, eatsMeat: false,
            laysEggs: false, hasShell: false, hasTail: true, makesSounds: true, isWild: false,
            liveOnLand: true, livesInWater: false, canSwim: false, hasWings: false
          } 
        },
        { 
          name: 'Turtle', 
          props: { 
            isAnimal: true, isLiving: true, hasLegs: true, canFly: false, isBig: false,
            hasFur: false, hasWings: false, isPet: true, isDangerous: false, eatsMeat: false,
            laysEggs: true, isMammal: false, isBird: false, hasShell: true, hasTail: true,
            makesSounds: false, isWild: false, liveOnLand: true, livesInWater: true, canSwim: true
          } 
        },
        { 
          name: 'Horse', 
          props: { 
            isAnimal: true, isLiving: true, isMammal: true, hasLegs: true, hasFur: true,
            canFly: false, isPet: false, isBig: true, isDangerous: false, eatsMeat: false,
            laysEggs: false, hasShell: false, hasTail: true, makesSounds: true, isWild: false,
            liveOnLand: true, livesInWater: false, canSwim: false, hasWings: false
          } 
        },
        { 
          name: 'Owl', 
          props: { 
            isAnimal: true, isLiving: true, isBird: true, canFly: true, hasWings: true,
            hasLegs: true, isBig: false, hasFur: false, isPet: false, isDangerous: false,
            eatsMeat: true, laysEggs: true, isMammal: false, hasShell: false, hasTail: true,
            makesSounds: true, isWild: true, liveOnLand: false, livesInWater: false
          } 
        }
      ],
      objects: [
        { 
          name: 'Piano', 
          props: { 
            isAnimal: false, isLiving: false, isBig: true, makesSound: true, isMusical: true, 
            hasKeys: true, isElectronic: false, isPortable: false, usesElectricity: false,
            isTool: false, isVehicle: false, isFurniture: true, madeOfWood: true, madeOfMetal: true,
            isExpensive: true, foundInHome: true, canBreak: true, isHeavy: true
          } 
        },
        { 
          name: 'Laptop', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: true, hasScreen: true, 
            isPortable: true, usesElectricity: true, isBig: false, isMusical: false,
            isTool: true, isVehicle: false, isFurniture: false, madeOfMetal: true, madeOfWood: false,
            isExpensive: true, foundInHome: true, canBreak: true, makesSound: true, isHeavy: false
          } 
        },
        { 
          name: 'Guitar', 
          props: { 
            isAnimal: false, isLiving: false, isMusical: true, hasStrings: true, 
            isPortable: true, makesSound: true, isBig: false, isElectronic: false,
            usesElectricity: false, isTool: false, isVehicle: false, isFurniture: false,
            madeOfWood: true, madeOfMetal: false, isExpensive: false, foundInHome: true, canBreak: true, isHeavy: false
          } 
        },
        { 
          name: 'Book', 
          props: { 
            isAnimal: false, isLiving: false, isPortable: true, isBig: false, hasPages: true,
            madeOfWood: true, isElectronic: false, usesElectricity: false, makesSound: false,
            isTool: false, isVehicle: false, isFurniture: false, madeOfMetal: false,
            isExpensive: false, foundInHome: true, canBreak: true, isHeavy: false, isMusical: false
          } 
        },
        { 
          name: 'Television', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: true, hasScreen: true,
            isPortable: false, usesElectricity: true, isBig: true, isMusical: false,
            isTool: false, isVehicle: false, isFurniture: true, madeOfMetal: true, madeOfWood: false,
            isExpensive: true, foundInHome: true, canBreak: true, makesSound: true, isHeavy: true
          } 
        },
        { 
          name: 'Chair', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: false, isPortable: true,
            usesElectricity: false, isBig: false, isMusical: false, isTool: false,
            isVehicle: false, isFurniture: true, madeOfWood: true, madeOfMetal: false,
            isExpensive: false, foundInHome: true, canBreak: true, makesSound: false, isHeavy: false
          } 
        },
        { 
          name: 'Refrigerator', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: true, usesElectricity: true,
            isBig: true, isPortable: false, isMusical: false, isTool: false,
            isVehicle: false, isFurniture: true, madeOfMetal: true, madeOfWood: false,
            isExpensive: true, foundInHome: true, canBreak: true, makesSound: true, isHeavy: true
          } 
        },
        { 
          name: 'Clock', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: true, usesElectricity: true,
            isBig: false, isPortable: true, isMusical: false, makesSound: true,
            isTool: false, isVehicle: false, isFurniture: false, madeOfMetal: true, madeOfWood: false,
            isExpensive: false, foundInHome: true, canBreak: true, isHeavy: false
          } 
        },
        { 
          name: 'Hammer', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: false, usesElectricity: false,
            isBig: false, isPortable: true, isMusical: false, makesSound: false,
            isTool: true, isVehicle: false, isFurniture: false, madeOfMetal: true, madeOfWood: true,
            isExpensive: false, foundInHome: true, canBreak: false, isHeavy: false
          } 
        },
        { 
          name: 'Mirror', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: false, usesElectricity: false,
            isBig: false, isPortable: true, isMusical: false, makesSound: false,
            isTool: false, isVehicle: false, isFurniture: false, madeOfMetal: false, madeOfWood: false,
            isExpensive: false, foundInHome: true, canBreak: true, isHeavy: false
          } 
        },
        { 
          name: 'Lamp', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: true, usesElectricity: true,
            isBig: false, isPortable: true, isMusical: false, makesSound: false,
            isTool: false, isVehicle: false, isFurniture: false, madeOfMetal: true, madeOfWood: false,
            isExpensive: false, foundInHome: true, canBreak: true, isHeavy: false
          } 
        },
        { 
          name: 'Microwave', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: true, usesElectricity: true,
            isBig: false, isPortable: false, isMusical: false, makesSound: true,
            isTool: false, isVehicle: false, isFurniture: true, madeOfMetal: true, madeOfWood: false,
            isExpensive: true, foundInHome: true, canBreak: true, isHeavy: true
          } 
        },
        { 
          name: 'Backpack', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: false, usesElectricity: false,
            isBig: false, isPortable: true, isMusical: false, makesSound: false,
            isTool: false, isVehicle: false, isFurniture: false, madeOfMetal: false, madeOfWood: false,
            isExpensive: false, foundInHome: true, canBreak: false, isHeavy: false
          } 
        },
        { 
          name: 'Telephone', 
          props: { 
            isAnimal: false, isLiving: false, isElectronic: true, usesElectricity: true,
            isBig: false, isPortable: true, isMusical: false, makesSound: true,
            isTool: true, isVehicle: false, isFurniture: false, madeOfMetal: true, madeOfWood: false,
            isExpensive: true, foundInHome: true, canBreak: true, isHeavy: false
          } 
        }
      ],
      food: [
        { 
          name: 'Banana', 
          props: { 
            isAnimal: false, isLiving: true, isFood: true, isYellow: true, isFruit: true, 
            grows: true, isSweet: true, isVegetable: false, needsCooking: false, isHealthy: true,
            isBig: false, isDrink: false, isHot: false, isCold: false, hasSeed: true
          } 
        },
        { 
          name: 'Pizza', 
          props: { 
            isAnimal: false, isLiving: false, isFood: true, needsCooking: true, isHealthy: false,
            isFruit: false, isVegetable: false, grows: false, isSweet: false, isYellow: false,
            isBig: false, isDrink: false, isHot: true, isCold: false, hasSeed: false
          } 
        },
        { 
          name: 'Apple', 
          props: { 
            isAnimal: false, isLiving: true, isFood: true, isFruit: true, grows: true,
            isSweet: true, isHealthy: true, needsCooking: false, isVegetable: false, isYellow: false,
            isBig: false, isDrink: false, isHot: false, isCold: false, hasSeed: true
          } 
        },
        { 
          name: 'Ice Cream', 
          props: { 
            isAnimal: false, isLiving: false, isFood: true, isCold: true, isSweet: true,
            needsCooking: false, isHealthy: false, isFruit: false, isVegetable: false, grows: false,
            isYellow: false, isBig: false, isDrink: false, isHot: false, hasSeed: false
          } 
        }
      ],
      nature: [
        { 
          name: 'Rose', 
          props: { 
            isAnimal: false, isLiving: true, isPlant: true, hasFlower: true, hasThorns: true, 
            smellsGood: true, grows: true, isTree: false, isBig: false, needsWater: true,
            needsSunlight: true, hasLeaves: true, isFruit: false, isVegetable: false, isFood: false
          } 
        },
        { 
          name: 'Sun', 
          props: { 
            isAnimal: false, isLiving: false, isBright: true, isHot: true, isInSky: true, 
            givesLight: true, isBig: true, isPlant: false, grows: false, needsWater: false,
            isNatural: true, canTouch: false, moves: true, isYellow: true
          } 
        },
        { 
          name: 'Tree', 
          props: { 
            isAnimal: false, isLiving: true, isPlant: true, isBig: true, grows: true,
            hasLeaves: true, isTree: true, hasFlower: false, needsWater: true, needsSunlight: true,
            hasThorns: false, smellsGood: false, isFruit: false, isVegetable: false, isFood: false
          } 
        },
        { 
          name: 'Ocean', 
          props: { 
            isAnimal: false, isLiving: false, isBig: true, hasWater: true, isWet: true,
            isNatural: true, isPlant: false, grows: false, isInSky: false, isBright: false,
            isHot: false, givesLight: false, canTouch: true, moves: true
          } 
        }
      ],
      vehicles: [
        { 
          name: 'Airplane', 
          props: { 
            isAnimal: false, isLiving: false, canFly: true, isBig: true, carriesPeople: true, 
            hasWings: true, isVehicle: true, usesElectricity: false, needsFuel: true,
            makesSound: true, isExpensive: true, hasWheels: true, goesUnderground: false, goesOnWater: false
          } 
        },
        { 
          name: 'Bicycle', 
          props: { 
            isAnimal: false, isLiving: false, isVehicle: true, hasWheels: true, isBig: false,
            carriesPeople: true, canFly: false, usesElectricity: false, needsFuel: false,
            makesSound: false, isExpensive: false, hasWings: false, goesUnderground: false, goesOnWater: false
          } 
        },
        { 
          name: 'Boat', 
          props: { 
            isAnimal: false, isLiving: false, isVehicle: true, goesOnWater: true, isBig: true,
            carriesPeople: true, canFly: false, hasWheels: false, usesElectricity: false,
            needsFuel: true, makesSound: true, isExpensive: true, hasWings: false, goesUnderground: false
          } 
        }
      ]
    };

    let selectedCategory = null;
    let currentItem = null;
    let questions = [];
    let gameState = 'category'; // category, playing, won, lost

    function startNewGame(category) {
      const items = CATEGORIES[category];
      const randomItem = items[Math.floor(Math.random() * items.length)];
      
      selectedCategory = category;
      currentItem = randomItem;
      questions = [];
      gameState = 'playing';
      
      document.getElementById('category-screen').style.display = 'none';
      document.getElementById('result-screen').style.display = 'none';
      document.getElementById('game-screen').style.display = 'block';
      document.getElementById('current-category').textContent = category;
      
      updateQuestionsDisplay();
      showQuestionInput();
    }

    function returnToCategories() {
      gameState = 'category';
      selectedCategory = null;
      currentItem = null;
      questions = [];
      
      document.getElementById('category-screen').style.display = 'block';
      document.getElementById('game-screen').style.display = 'none';
      document.getElementById('result-screen').style.display = 'none';
      
      // Clear inputs
      document.getElementById('question-input').value = '';
      document.getElementById('guess-input').value = '';
    }

    function analyzeQuestion(question) {
      const q = question.toLowerCase();
      const props = currentItem.props;

      // Animal related
      if (q.includes('animal')) return props.isAnimal ? 'yes' : 'no';
      if (q.includes('mammal')) return props.isMammal ? 'yes' : 'no';
      if (q.includes('bird')) return props.isBird ? 'yes' : 'no';
      if (q.includes('pet')) return props.isPet ? 'yes' : 'no';
      if (q.includes('wild')) return props.isWild ? 'yes' : 'no';
      if (q.includes('dangerous')) return props.isDangerous ? 'yes' : 'no';
      if (q.includes('fur') || q.includes('furry') || q.includes('hairy')) return props.hasFur ? 'yes' : 'no';
      
      // Living/Nature
      if (q.includes('living') || q.includes('alive')) return props.isLiving ? 'yes' : 'no';
      if (q.includes('plant')) return props.isPlant ? 'yes' : 'no';
      if (q.includes('tree')) return props.isTree ? 'yes' : 'no';
      if (q.includes('flower')) return props.hasFlower ? 'yes' : 'no';
      if (q.includes('grow')) return props.grows ? 'yes' : 'no';
      if (q.includes('natural') || q.includes('nature')) return props.isNatural ? 'yes' : 'no';
      
      // Size
      if (q.includes('big') || q.includes('large') || q.includes('huge')) return props.isBig ? 'yes' : 'no';
      if (q.includes('small') || q.includes('tiny') || q.includes('little')) return props.isBig === false ? 'yes' : 'no';
      if (q.includes('heavy')) return props.isHeavy ? 'yes' : 'no';
      
      // Movement/Abilities
      if (q.includes('fly')) return props.canFly ? 'yes' : 'no';
      if (q.includes('swim')) return props.canSwim ? 'yes' : 'no';
      if (q.includes('walk')) return props.hasLegs ? 'yes' : 'no';
      if (q.includes('move')) return props.moves !== undefined ? (props.moves ? 'yes' : 'no') : (props.isLiving || props.isVehicle ? 'yes' : 'no');
      
      // Location/Habitat
      if (q.includes('water') || q.includes('ocean') || q.includes('sea')) {
        return (props.livesInWater || props.goesOnWater || props.hasWater) ? 'yes' : 'no';
      }
      if (q.includes('land')) return props.liveOnLand ? 'yes' : 'no';
      if (q.includes('sky') || q.includes('air')) return props.isInSky || props.canFly ? 'yes' : 'no';
      if (q.includes('cold') || q.includes('ice') || q.includes('frozen')) return props.livesCold || props.isCold ? 'yes' : 'no';
      if (q.includes('home') || q.includes('house') || q.includes('indoor')) return props.foundInHome ? 'yes' : 'no';
      if (q.includes('underground')) return props.goesUnderground ? 'yes' : 'no';
      
      // Physical features
      if (q.includes('leg')) return props.hasLegs ? 'yes' : 'no';
      if (q.includes('wing')) return props.hasWings ? 'yes' : 'no';
      if (q.includes('tail')) return props.hasTail ? 'yes' : 'no';
      if (q.includes('trunk')) return props.hasTrunk ? 'yes' : 'no';
      if (q.includes('thorn')) return props.hasThorns ? 'yes' : 'no';
      if (q.includes('shell')) return props.hasShell ? 'yes' : 'no';
      if (q.includes('wheel')) return props.hasWheels ? 'yes' : 'no';
      if (q.includes('screen')) return props.hasScreen ? 'yes' : 'no';
      if (q.includes('key') && !q.includes('monkey')) return props.hasKeys ? 'yes' : 'no';
      if (q.includes('string')) return props.hasStrings ? 'yes' : 'no';
      if (q.includes('page')) return props.hasPages ? 'yes' : 'no';
      if (q.includes('leaf') || q.includes('leaves')) return props.hasLeaves ? 'yes' : 'no';
      if (q.includes('seed')) return props.hasSeed ? 'yes' : 'no';
      
      // Sound/Senses
      if (q.includes('sound') || q.includes('noise') || q.includes('loud')) return props.makesSound || props.makesSounds ? 'yes' : 'no';
      if (q.includes('music') || q.includes('instrument')) return props.isMusical ? 'yes' : 'no';
      if (q.includes('smell')) return props.smellsGood ? 'yes' : 'no';
      if (q.includes('bright') || q.includes('light') || q.includes('shine')) {
        return (props.isBright || props.givesLight) ? 'yes' : 'no';
      }
      
      // Food related
      if (q.includes('food') || q.includes('eat')) {
        if (props.isFood !== undefined) return props.isFood ? 'yes' : 'no';
        if (props.eatsMeat !== undefined) return props.eatsMeat ? 'yes' : 'no';
        return 'no';
      }
      if (q.includes('fruit')) return props.isFruit ? 'yes' : 'no';
      if (q.includes('vegetable')) return props.isVegetable ? 'yes' : 'no';
      if (q.includes('sweet')) return props.isSweet ? 'yes' : 'no';
      if (q.includes('healthy')) return props.isHealthy ? 'yes' : 'no';
      if (q.includes('cook')) return props.needsCooking ? 'yes' : 'no';
      if (q.includes('drink')) return props.isDrink ? 'yes' : 'no';
      
      // Technology/Objects
      if (q.includes('electronic') || q.includes('electric')) return props.isElectronic || props.usesElectricity ? 'yes' : 'no';
      if (q.includes('tool')) return props.isTool ? 'yes' : 'no';
      if (q.includes('vehicle') || q.includes('transportation')) return props.isVehicle ? 'yes' : 'no';
      if (q.includes('furniture')) return props.isFurniture ? 'yes' : 'no';
      if (q.includes('portable') || q.includes('carry')) return props.isPortable ? 'yes' : 'no';
      if (q.includes('expensive') || q.includes('costly')) return props.isExpensive ? 'yes' : 'no';
      if (q.includes('break')) return props.canBreak ? 'yes' : 'no';
      if (q.includes('touch')) return props.canTouch !== undefined ? (props.canTouch ? 'yes' : 'no') : 'yes';
      
      // Materials
      if (q.includes('wood') || q.includes('wooden')) return props.madeOfWood ? 'yes' : 'no';
      if (q.includes('metal')) return props.madeOfMetal ? 'yes' : 'no';
      if (q.includes('wet')) return props.isWet ? 'yes' : 'no';
      
      // Colors
      if (q.includes('yellow')) return props.isYellow ? 'yes' : 'no';
      
      // Temperature
      if (q.includes('hot') || q.includes('warm')) return props.isHot ? 'yes' : 'no';
      
      // Intelligence/Behavior
      if (q.includes('smart') || q.includes('intelligent')) return props.isSmart ? 'yes' : 'no';
      
      // Other
      if (q.includes('people') || q.includes('person') || q.includes('human')) {
        return props.carriesPeople ? 'yes' : 'no';
      }
      if (q.includes('fuel') || q.includes('gas')) return props.needsFuel ? 'yes' : 'no';
      if (q.includes('water') && (q.includes('need') || q.includes('require'))) return props.needsWater ? 'yes' : 'no';
      if (q.includes('sun') && (q.includes('need') || q.includes('require'))) return props.needsSunlight ? 'yes' : 'no';
      if (q.includes('egg')) return props.laysEggs ? 'yes' : 'no';
      if (q.includes('meat')) return props.eatsMeat ? 'yes' : 'no';

      // Default: if we can't determine, give a reasonable default based on context
      return 'no';
    }

    function askQuestion() {
      const questionInput = document.getElementById('question-input');
      const question = questionInput.value.trim();
      
      if (!question || questions.length >= 20 || gameState !== 'playing') return;

      const answer = analyzeQuestion(question);
      questions.push({ question: question, answer: answer });
      questionInput.value = '';
      
      updateQuestionsDisplay();
    }

    function updateQuestionsDisplay() {
      const questionsCount = document.getElementById('questions-count');
      const questionsRemaining = document.getElementById('questions-remaining');
      const questionsList = document.getElementById('questions-list');
      const progressFill = document.getElementById('progress-fill');
      
      questionsCount.textContent = questions.length;
      questionsRemaining.textContent = 20 - questions.length;
      
      // Update progress bar
      const progressPercentage = (questions.length / 20) * 100;
      progressFill.style.width = progressPercentage + '%';
      
      if (questions.length === 0) {
        questionsList.innerHTML = '<p style="color: rgba(255,255,255,0.6); font-style: italic;">No questions asked yet...</p>';
      } else {
        questionsList.innerHTML = questions.map((q, idx) => `
          <div class="question-item">
            <div class="question-text">Q${idx + 1}: ${q.question}</div>
            <div class="answer-text answer-${q.answer}">A: ${q.answer.toUpperCase()}</div>
          </div>
        `).join('');
      }
      
      // Check if game should end
      if (questions.length >= 20) {
        endGame(false);
      }
    }

    function showQuestionInput() {
      document.getElementById('question-input-section').style.display = 'block';
      document.getElementById('guess-input-section').style.display = 'none';
    }

    function showGuessInput() {
      document.getElementById('question-input-section').style.display = 'none';
      document.getElementById('guess-input-section').style.display = 'block';
      document.getElementById('guess-input').focus();
    }

    function submitGuess() {
      const guessInput = document.getElementById('guess-input');
      const guess = guessInput.value.trim();
      
      if (!guess) return;

      if (guess.toLowerCase() === currentItem.name.toLowerCase()) {
        endGame(true);
      } else {
        if (questions.length >= 19) {
          endGame(false);
        } else {
          questions.push({ question: `Is it a ${guess}?`, answer: 'no' });
          updateQuestionsDisplay();
          guessInput.value = '';
          showQuestionInput();
        }
      }
    }

    function endGame(won) {
      gameState = won ? 'won' : 'lost';
      
      document.getElementById('game-screen').style.display = 'none';
      document.getElementById('result-screen').style.display = 'block';
      
      const resultContent = document.getElementById('result-content');
      resultContent.className = `game-result ${won ? 'result-won' : 'result-lost'}`;
      
      if (won) {
        resultContent.innerHTML = `
          <div class="result-icon">üèÜ</div>
          <h2>Congratulations! You Won!</h2>
          <p>You correctly guessed it was a <strong>${currentItem.name}</strong> in ${questions.length} questions!</p>
          <p>Great detective work! üïµÔ∏è‚Äç‚ôÇÔ∏è</p>
        `;
      } else {
        resultContent.innerHTML = `
          <div class="result-icon">üòÖ</div>
          <h2>Game Over!</h2>
          <p>You've used all 20 questions. It was a <strong>${currentItem.name}</strong>!</p>
          <p>Better luck next time! Keep practicing your questioning skills. üí™</p>
        `;
      }
    }

    function handleQuestionKeyPress(event) {
      if (event.key === 'Enter') {
        askQuestion();
      }
    }

    function handleGuessKeyPress(event) {
      if (event.key === 'Enter') {
        submitGuess();
      }
    }

    // Guest user support
    const guestUser = {
      uid: "guest-" + Math.random().toString(36).slice(2),
      displayName: "Guest Player"
    };
    localStorage.setItem("guestUser", JSON.stringify(guestUser));
  </script>
</body>
</html>
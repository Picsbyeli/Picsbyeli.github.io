<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîí Escape the Haunted Room</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #fff;
            overflow: hidden;
        }

        #intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #1a0a0a 0%, #3d1a1a 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: flicker 2s infinite;
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.95; }
        }

        #intro-screen h1 {
            font-size: 3em;
            text-shadow: 0 0 20px #ff0000;
            margin-bottom: 20px;
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 20px #ff0000; }
            50% { text-shadow: 0 0 40px #ff0000, 0 0 60px #ff0000; }
        }

        #intro-screen p {
            font-size: 1.3em;
            margin-bottom: 30px;
            text-align: center;
            max-width: 600px;
            padding: 0 20px;
        }

        #start-btn {
            padding: 15px 40px;
            font-size: 1.2em;
            background: #8b0000;
            color: #fff;
            border: 2px solid #ff0000;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Courier New', monospace;
        }

        #start-btn:hover {
            background: #ff0000;
            box-shadow: 0 0 20px #ff0000;
            transform: scale(1.05);
        }

        #game-screen {
            display: none;
            width: 100%;
            height: 100vh;
            position: relative;
        }

        #room {
            width: 100%;
            height: 100vh;
            background: linear-gradient(to bottom, #1a0a0a 0%, #2d1a1a 50%, #1a0a0a 100%);
            position: relative;
            overflow: hidden;
        }

        #timer {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 2em;
            background: rgba(0,0,0,0.8);
            padding: 15px 25px;
            border: 2px solid #ff0000;
            border-radius: 10px;
            z-index: 100;
            box-shadow: 0 0 20px rgba(255,0,0,0.5);
        }

        #inventory {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border: 2px solid #ff0000;
            border-radius: 10px;
            min-width: 200px;
            z-index: 100;
        }

        #inventory h3 {
            margin-bottom: 10px;
            color: #ff6666;
        }

        .item {
            margin: 5px 0;
            padding: 5px;
            background: rgba(139,0,0,0.3);
            border-radius: 3px;
        }

        .hotspot {
            position: absolute;
            cursor: pointer;
            transition: all 0.3s;
        }

        .hotspot:hover {
            filter: brightness(1.3);
            transform: scale(1.05);
        }

        #bookshelf {
            left: 5%;
            top: 20%;
            width: 200px;
            height: 300px;
            background: linear-gradient(to right, #3d2a1a 0%, #5d3a2a 50%, #3d2a1a 100%);
            border: 3px solid #2a1a0a;
            display: flex;
            flex-direction: column;
            padding: 10px;
            gap: 5px;
        }

        .book {
            height: 30px;
            background: linear-gradient(to right, #8b4513, #654321);
            border: 1px solid #000;
        }

        #locked-box {
            right: 10%;
            bottom: 25%;
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, #4a4a4a, #2a2a2a);
            border: 4px solid #1a1a1a;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }

        #painting {
            left: 40%;
            top: 15%;
            width: 180px;
            height: 220px;
            background: linear-gradient(135deg, #4a2a1a, #2a1a0a);
            border: 8px solid #8b7355;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3em;
        }

        #desk {
            left: 60%;
            bottom: 15%;
            width: 250px;
            height: 150px;
            background: linear-gradient(to bottom, #5d4a3a, #3d2a1a);
            border: 3px solid #2a1a0a;
            border-radius: 5px;
        }

        #candle {
            left: 30%;
            bottom: 30%;
            width: 40px;
            height: 80px;
            background: linear-gradient(to bottom, #fffacd, #f0e68c);
            border-radius: 5px 5px 0 0;
            position: relative;
        }

        #candle::before {
            content: '';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 20px solid transparent;
        }

        #candle.lit::before {
            border-bottom-color: #ff6600;
            animation: flame 0.5s infinite alternate;
        }

        @keyframes flame {
            0% { transform: translateX(-50%) scale(1); }
            100% { transform: translateX(-50%) scale(1.1); }
        }

        #door {
            right: 5%;
            top: 20%;
            width: 120px;
            height: 280px;
            background: linear-gradient(to right, #4a2a1a, #2a1a0a);
            border: 5px solid #1a0a0a;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2em;
        }

        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.95);
            border: 3px solid #ff0000;
            padding: 30px;
            border-radius: 15px;
            z-index: 200;
            max-width: 500px;
            box-shadow: 0 0 50px rgba(255,0,0,0.8);
        }

        .modal h2 {
            color: #ff6666;
            margin-bottom: 15px;
        }

        .modal input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            font-size: 1.2em;
            background: #1a0a0a;
            border: 2px solid #ff0000;
            color: #fff;
            font-family: 'Courier New', monospace;
        }

        .modal button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 1em;
            background: #8b0000;
            color: #fff;
            border: 2px solid #ff0000;
            cursor: pointer;
            font-family: 'Courier New', monospace;
        }

        .modal button:hover {
            background: #ff0000;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 199;
        }

        #end-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #0a1a0a 0%, #1a3d1a 100%);
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 1000;
        }

        #end-screen.lose {
            background: linear-gradient(135deg, #1a0a0a 0%, #3d1a1a 100%);
        }

        #end-screen h1 {
            font-size: 4em;
            margin-bottom: 20px;
        }

        #end-screen.win h1 {
            color: #00ff00;
            text-shadow: 0 0 30px #00ff00;
        }

        #end-screen.lose h1 {
            color: #ff0000;
            text-shadow: 0 0 30px #ff0000;
        }

        .clue {
            background: rgba(139,0,0,0.2);
            padding: 10px;
            margin: 10px 0;
            border-left: 3px solid #ff0000;
            font-style: italic;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 1001;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="window.location.href='../index.html'">‚Üê Back to Hub</button>

    <div id="intro-screen">
        <h1>üîí THE HAUNTED ROOM üîí</h1>
        <p>You wake up in a dark, locked room. Strange symbols cover the walls. A chill runs down your spine. You have 10 minutes to solve the puzzles and escape... or be trapped forever.</p>
        <button id="start-btn">ENTER THE ROOM</button>
    </div>

    <div id="game-screen">
        <div id="timer">‚è∞ 10:00</div>
        <div id="inventory">
            <h3>üì¶ Inventory</h3>
            <div id="items"></div>
        </div>
        
        <div id="room">
            <div class="hotspot" id="bookshelf">
                <div class="book"></div>
                <div class="book"></div>
                <div class="book"></div>
                <div class="book"></div>
                <div class="book"></div>
            </div>
            
            <div class="hotspot" id="locked-box">üîí</div>
            
            <div class="hotspot" id="painting">üñºÔ∏è</div>
            
            <div class="hotspot" id="desk"></div>
            
            <div class="hotspot" id="candle"></div>
            
            <div class="hotspot" id="door">üö™</div>
        </div>
    </div>

    <div class="modal-overlay"></div>
    <div class="modal" id="puzzle-modal">
        <h2 id="modal-title"></h2>
        <div id="modal-content"></div>
        <button onclick="closeModal()">Close</button>
    </div>

    <div id="end-screen">
        <h1 id="end-message"></h1>
        <p id="end-detail"></p>
        <button onclick="location.reload()" style="margin-top: 20px; padding: 15px 40px; font-size: 1.2em; background: #8b0000; color: #fff; border: 2px solid #ff0000; cursor: pointer; font-family: 'Courier New', monospace;">Try Again</button>
    </div>

    <script>
        let timeLeft = 600;
        let timerInterval;
        let inventory = [];
        let puzzles = {
            bookshelf: false,
            painting: false,
            candle: false,
            box: false,
            desk: false
        };
        
        let finalCode = '325';
        let riddleAnswer = 'fire';

        document.getElementById('start-btn').addEventListener('click', startGame);

        function startGame() {
            document.getElementById('intro-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'block';
            startTimer();
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                let minutes = Math.floor(timeLeft / 60);
                let seconds = timeLeft % 60;
                document.getElementById('timer').textContent = `‚è∞ ${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    endGame(false);
                }
            }, 1000);
        }

        function addToInventory(item) {
            inventory.push(item);
            updateInventory();
        }

        function updateInventory() {
            let itemsDiv = document.getElementById('items');
            itemsDiv.innerHTML = inventory.map(item => `<div class="item">${item}</div>`).join('');
        }

        function showModal(title, content) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-content').innerHTML = content;
            document.querySelector('.modal-overlay').style.display = 'block';
            document.getElementById('puzzle-modal').style.display = 'block';
        }

        function closeModal() {
            document.querySelector('.modal-overlay').style.display = 'none';
            document.getElementById('puzzle-modal').style.display = 'none';
        }

        document.getElementById('bookshelf').addEventListener('click', function() {
            if (!puzzles.bookshelf) {
                showModal('üìö Ancient Bookshelf', `
                    <p>You examine the dusty books. One stands out with strange markings:</p>
                    <div class="clue">"I am always hungry, I must always be fed. The finger I touch will soon turn red."</div>
                    <p>What am I?</p>
                    <input type="text" id="riddle-input" placeholder="Enter your answer...">
                    <button onclick="checkRiddle()">Submit</button>
                `);
            } else {
                showModal('üìö Bookshelf', '<p>You\'ve already solved this riddle. The word was: FIRE üî•</p>');
            }
        });

        function checkRiddle() {
            let answer = document.getElementById('riddle-input').value.toLowerCase().trim();
            if (answer === riddleAnswer) {
                puzzles.bookshelf = true;
                addToInventory('üî• Riddle Answer: FIRE');
                showModal('‚úÖ Correct!', '<p>The book glows briefly. You feel warmth spreading through the room. This might be useful with something else...</p>');
            } else {
                showModal('‚ùå Incorrect', '<p>That\'s not right. Think about what consumes and produces heat...</p>');
            }
        }

        document.getElementById('painting').addEventListener('click', function() {
            if (!puzzles.painting) {
                puzzles.painting = true;
                addToInventory('üé® First digit: 3');
                showModal('üñºÔ∏è Mysterious Painting', `
                    <p>You examine the old painting closely. Behind the frame, you find scratches carved into the wall:</p>
                    <div class="clue">|||  (three lines)</div>
                    <p>This looks like the first digit of a code!</p>
                `);
            } else {
                showModal('üñºÔ∏è Painting', '<p>The scratches show: ||| (3)</p>');
            }
        });

        document.getElementById('candle').addEventListener('click', function() {
            if (!puzzles.candle && puzzles.bookshelf) {
                puzzles.candle = true;
                document.getElementById('candle').classList.add('lit');
                addToInventory('üïØÔ∏è Second digit: 2');
                showModal('üïØÔ∏è Candle Lit!', `
                    <p>You light the candle with fire. The flame reveals hidden writing on the wall:</p>
                    <div class="clue">"Two paths diverge" - 2</div>
                    <p>This looks like the second digit!</p>
                `);
            } else if (!puzzles.bookshelf) {
                showModal('üïØÔ∏è Candle', '<p>You need fire to light this candle. Perhaps solve the riddle first?</p>');
            } else {
                showModal('üïØÔ∏è Candle', '<p>The flame reveals the number: 2</p>');
            }
        });

        document.getElementById('desk').addEventListener('click', function() {
            if (!puzzles.desk) {
                puzzles.desk = true;
                addToInventory('üóùÔ∏è Rusty Key');
                addToInventory('üìù Third digit: 5');
                showModal('üóùÔ∏è Desk Drawer', `
                    <p>You open the drawer and find a rusty key and a note:</p>
                    <div class="clue">"Five fingers reach for freedom" - 5</div>
                    <p>The key might unlock something... And that's the third digit!</p>
                `);
            } else {
                showModal('üóùÔ∏è Desk', '<p>Empty drawer. You already took the key and found: 5</p>');
            }
        });

        document.getElementById('locked-box').addEventListener('click', function() {
            if (puzzles.painting && puzzles.candle && puzzles.desk) {
                showModal('üîí Locked Box', `
                    <p>The box has a 3-digit combination lock. You've found three numbers...</p>
                    <p>üé® Painting: 3<br>üïØÔ∏è Candle: 2<br>üìù Note: 5</p>
                    <input type="text" id="box-code" placeholder="Enter 3-digit code" maxlength="3">
                    <button onclick="checkBoxCode()">Unlock</button>
                `);
            } else {
                showModal('üîí Locked Box', '<p>This box needs a 3-digit code. You need to find all three digits first...</p>');
            }
        });

        function checkBoxCode() {
            let code = document.getElementById('box-code').value;
            if (code === finalCode) {
                puzzles.box = true;
                addToInventory('üéâ Box Unlocked!');
                showModal('‚úÖ Box Opened!', '<p>Inside you find the final confirmation: The door code is indeed 325!</p>');
            } else {
                showModal('‚ùå Wrong Code', '<p>The box remains locked. Check your clues again...</p>');
            }
        }

        document.getElementById('door').addEventListener('click', function() {
            if (inventory.includes('üóùÔ∏è Rusty Key')) {
                showModal('üö™ Exit Door', `
                    <p>You insert the rusty key. A keypad appears with 3 digit slots.</p>
                    <p>Enter the code to escape:</p>
                    <input type="text" id="door-code" placeholder="Enter 3-digit code" maxlength="3">
                    <button onclick="checkDoorCode()">Unlock Door</button>
                `);
            } else {
                showModal('üö™ Locked Door', '<p>The door is locked. You need a key first!</p>');
            }
        });

        function checkDoorCode() {
            let code = document.getElementById('door-code').value;
            if (code === finalCode) {
                endGame(true);
            } else {
                showModal('‚ùå Wrong Code', '<p>The door remains locked. The code must be somewhere in the room...</p>');
            }
        }

        function endGame(won) {
            clearInterval(timerInterval);
            closeModal();
            
            let endScreen = document.getElementById('end-screen');
            let message = document.getElementById('end-message');
            let detail = document.getElementById('end-detail');
            
            if (won) {
                endScreen.classList.add('win');
                message.textContent = 'üéâ YOU ESCAPED! üéâ';
                let mins = Math.floor((600 - timeLeft) / 60);
                let secs = (600 - timeLeft) % 60;
                detail.textContent = `Congratulations! You escaped in ${mins}:${secs.toString().padStart(2, '0')}!`;
            } else {
                endScreen.classList.add('lose');
                message.textContent = 'üíÄ TIME\'S UP üíÄ';
                detail.textContent = 'The room goes dark forever... You are trapped for eternity.';
            }
            
            endScreen.style.display = 'flex';
        }
    </script>
</body>
</html>